<!DOCTYPE html>
<html lang="ja" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã‚¹ãƒãƒ›Webå·¥æˆ¿</title>
<style>
/* =========================================
   UI Variables & Base
   ========================================= */
:root {
    --header-h: 60px;
    --radius-md: 12px;
    --ui-primary: #020562;
    --ui-accent: #22AEC9;
    --ui-bg: #F8FAFC;
    --ui-surface: #FFFFFF;
    --ui-text: #334155;
    --ui-text-muted: #64748B;
    --ui-border: #E2E8F0;
    --ui-success: #10B981;
    --ui-danger: #EF4444;
}

[data-theme="dark"] {
    --ui-primary: #818cf8;
    --ui-accent: #38bdf8;
    --ui-bg: #0f172a;
    --ui-surface: #1e293b;
    --ui-text: #f1f5f9;
    --ui-text-muted: #94a3b8;
    --ui-border: #334155;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
body {
    margin: 0; padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    background-color: var(--ui-bg);
    color: var(--ui-text);
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* =========================================
   Header & Switcher
   ========================================= */
.app-header {
    height: var(--header-h);
    background: var(--ui-surface);
    border-bottom: 1px solid var(--ui-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 12px;
    z-index: 100;
    flex-shrink: 0;
}

.app-logo { font-weight: 800; font-size: 0.9rem; color: var(--ui-primary); }

.view-switcher {
    display: flex; background: #eee;
    padding: 3px; border-radius: 25px;
}
.switch-btn {
    padding: 8px 16px; border-radius: 20px; border: none;
    background: transparent; color: #666;
    font-weight: bold; font-size: 0.85rem; cursor: pointer;
    transition: 0.2s;
}
.switch-btn.active {
    background: var(--ui-surface); color: var(--ui-primary);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* =========================================
   Main Panels (Fixed Layout)
   ========================================= */
.app-main {
    flex: 1;
    display: flex;
    overflow: hidden;
    position: relative;
}

.editor-panel, .preview-panel {
    height: 100%;
    width: 100%;
    flex-shrink: 0;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* PC: Side-by-side by default */
@media (min-width: 769px) {
    .editor-panel { width: 420px; border-right: 1px solid var(--ui-border); }
    .preview-panel { flex: 1; }
    
    /* Presentation mode on PC */
    .app-main.view-preview .editor-panel { display: none; }
}

/* Mobile: Overlay each other */
@media (max-width: 768px) {
    .app-logo { display: none; }
    .editor-panel, .preview-panel { position: absolute; inset: 0; }
    
    .app-main.view-editor .preview-panel { visibility: hidden; transform: translateX(100%); }
    .app-main.view-preview .editor-panel { visibility: hidden; transform: translateX(-100%); }
}

/* mode adjustments for "Presentation" */
.app-main.view-preview .preview-toolbar { display: none; }
.app-main.view-preview .preview-canvas { padding: 0; }
.app-main.view-preview .preview-frame-wrapper { width: 100% !important; height: 100% !important; border:none; border-radius:0; box-shadow: none; }

/* Components */
.editor-panel { background: var(--ui-surface); overflow-y: auto; display: flex; flex-direction: column; }
.preview-panel { background: #1e293b; display: flex; flex-direction: column; }

.step-container { padding: 20px; display: flex; flex-direction: column; gap: 24px; }
.step-title { font-weight: bold; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
.step-num { background: var(--ui-accent); color: #fff; width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; }

.input-sm { width: 100%; padding: 10px; border: 1px solid var(--ui-border); border-radius: 8px; background: #f9f9f9; font-size: 0.95rem; margin-top: 4px; color: #333; }
.color-pills { display: flex; gap: 10px; margin-top: 8px; }
.color-pill { width: 34px; height: 34px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; position: relative; }
.color-pill.active { border-color: var(--ui-text); transform: scale(1.1); }
.color-pill::after { content:''; position:absolute; inset:2px; border-radius:50%; background: var(--bg); }

.photo-deck { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
.photo-card { background: #f0f4f8; border: 2px dashed #cbd5e1; border-radius: var(--radius-md); position: relative; cursor: pointer; aspect-ratio: 4/3; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; }
.photo-card.hero { grid-column: 1 / -1; aspect-ratio: 16/9; border-color: var(--ui-accent); }
.photo-card.has-image { border-style: solid; border-color: transparent; }
.photo-preview { width: 100%; height: 100%; object-fit: cover; }
.photo-placeholder { font-size: 0.75rem; color: #64748b; font-weight: bold; text-align: center; }
.btn-photo-clear { position: absolute; top: 5px; right: 5px; width: 20px; height: 20px; border-radius: 50%; background: rgba(0,0,0,0.5); color: #fff; border: none; font-size: 10px; cursor: pointer; display: none; }
.photo-card.has-image:hover .btn-photo-clear { display: block; }

.preview-toolbar { height: 50px; background: rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; gap: 10px; }
.device-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: #fff; padding: 6px 12px; border-radius: 20px; font-size: 0.75rem; cursor: pointer; }
.device-btn.active { background: var(--ui-accent); border-color: var(--ui-accent); }

.preview-canvas { flex: 1; display: flex; justify-content: center; align-items: center; padding: 20px; overflow: auto; }
.preview-frame-wrapper { background: #fff; width: 100%; height: 100%; transition: 0.3s; }
.preview-frame-wrapper.mode-pc { max-width: 1000px; }
.preview-frame-wrapper.mode-mobile { width: 375px; max-height: 667px; border: 8px solid #333; border-radius: 24px; }
iframe { width: 100%; height: 100%; border: none; }

.demo-save-container { position: absolute; bottom: 25px; left: 50%; transform: translateX(-50%); display: none; z-index: 1000; }
.app-main.view-preview .demo-save-container { display: block; }
.btn-save-demo { background: var(--ui-success); color: #fff; border: none; padding: 16px 32px; border-radius: 50px; font-weight: bold; box-shadow: 0 10px 25px rgba(0,0,0,0.4); cursor: pointer; display: flex; align-items: center; gap: 8px; }

.toast { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: #333; color: #fff; padding: 12px 24px; border-radius: 30px; font-size: 0.85rem; opacity: 0; pointer-events: none; transition: 0.3s; z-index: 2000; }
.toast.active { opacity: 1; }

.btn-primary { background: var(--ui-primary); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer; }
.modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px; }
.modal-overlay.active { display: flex; }
.modal-box { background: var(--ui-surface); width: 100%; max-width: 450px; border-radius: 16px; overflow: hidden; display: flex; flex-direction: column; max-height: 90vh; }
.modal-header { padding: 16px; border-bottom: 1px solid var(--ui-border); font-weight: bold; display: flex; justify-content: space-between; }
.modal-body { padding: 20px; overflow-y: auto; }
.section-title { font-size: 0.8rem; font-weight: bold; color: var(--ui-accent); margin: 15px 0 5px 0; }
</style>
</head>
<body>

<header class="app-header">
    <div class="app-logo">ğŸ“± ã‚¹ãƒãƒ›Webå·¥æˆ¿</div>
    <div class="view-switcher">
        <button class="switch-btn active" id="mode-editor">ğŸ› ï¸ åˆ¶ä½œ</button>
        <button class="switch-btn" id="mode-preview">ğŸ“± å®Œæˆ</button>
    </div>
    <div class="app-actions">
        <button class="btn-icon" id="open-settings" style="background:none; border:none; font-size:1.2rem; cursor:pointer;">âš™ï¸</button>
        <button class="btn-primary hide-on-mobile" id="save-top">ä¿å­˜</button>
    </div>
</header>

<main class="app-main view-editor" id="main-container">
    <section class="editor-panel">
        <div class="step-container">
            <div>
                <div class="step-title"><span class="step-num">1</span> åŸºæœ¬è¨­å®š</div>
                <select id="industry-select" class="input-sm">
                    <option value="manufacturing">è£½é€ æ¥­</option>
                    <option value="wholesale">å¸æ¥­</option>
                    <option value="insurance">ä¿é™ºä»£ç†åº—</option>
                    <option value="renovation">å†…è£…ãƒ»ãƒªãƒ•ã‚©ãƒ¼ãƒ </option>
                </select>
                <div class="color-pills" id="color-pills"></div>
            </div>
            <div>
                <div class="step-title"><span class="step-num">2</span> JPGå†™çœŸã‚’ã‚»ãƒƒãƒˆ</div>
                <div class="photo-deck">
                    <div class="photo-card hero" data-target="hero">
                        <img src="" class="photo-preview" id="prev-hero" style="display:none">
                        <div class="photo-placeholder" id="ph-hero">ğŸ–¼ï¸ ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ç”»é¢.jpg</div>
                        <button class="btn-photo-clear" data-target="hero">âœ•</button>
                    </div>
                    <div class="photo-card" data-target="p1">
                        <img src="" class="photo-preview" id="prev-p1" style="display:none">
                        <div class="photo-placeholder" id="ph-p1">ğŸ“¸ ç”»é¢â‘ .jpg</div>
                        <button class="btn-photo-clear" data-target="p1">âœ•</button>
                    </div>
                    <div class="photo-card" data-target="p2">
                        <img src="" class="photo-preview" id="prev-p2" style="display:none">
                        <div class="photo-placeholder" id="ph-p2">ğŸ“¸ ç”»é¢â‘¡.jpg</div>
                        <button class="btn-photo-clear" data-target="p2">âœ•</button>
                    </div>
                    <div class="photo-card" data-target="p3">
                        <img src="" class="photo-preview" id="prev-p3" style="display:none">
                        <div class="photo-placeholder" id="ph-p3">ğŸ“¸ ç”»é¢â‘¢.jpg</div>
                        <button class="btn-photo-clear" data-target="p3">âœ•</button>
                    </div>
                </div>
            </div>
            <button class="btn-primary" id="btn-finish-jump" style="padding:16px;">ğŸ“± å®Œæˆãƒ‡ãƒ¢ç”»é¢ã¸é€²ã‚€</button>
        </div>
    </section>

    <section class="preview-panel">
        <div class="preview-toolbar">
            <button class="device-btn active" data-mode="pc">PCè¡¨ç¤º</button>
            <button class="device-btn" data-mode="mobile">ã‚¹ãƒãƒ›è¡¨ç¤º</button>
        </div>
        <div class="preview-canvas">
            <div class="preview-frame-wrapper mode-pc" id="frame-wrapper">
                <iframe id="preview-iframe"></iframe>
            </div>
        </div>
        <div class="demo-save-container">
            <button class="btn-save-demo" id="save-presentation">ğŸ’¾ ã“ã®ãƒ‡ãƒ¢ã‚µã‚¤ãƒˆã‚’ä¿å­˜ã™ã‚‹</button>
        </div>
    </section>
</main>

<!-- Settings Modal -->
<div class="modal-overlay" id="modal-settings">
    <div class="modal-box">
        <div class="modal-header"><span>è©³ç´°è¨­å®š</span><button id="close-modal" style="background:none; border:none; cursor:pointer;">âœ•</button></div>
        <div class="modal-body">
            <div class="section-title">ğŸ¢ ä¼šç¤¾æƒ…å ±</div>
            <input type="text" id="inp-company" class="input-sm" placeholder="ä¼šç¤¾å">
            <input type="text" id="inp-address" class="input-sm" placeholder="ä½æ‰€">
            <input type="text" id="inp-map" class="input-sm" placeholder="Googleãƒãƒƒãƒ—URL">
            <div class="section-title">âœ‰ï¸ é€£çµ¡å…ˆãƒ»SNS</div>
            <input type="email" id="inp-email" class="input-sm" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹">
            <input type="text" id="inp-line" class="input-sm" placeholder="LINE URL">
            <input type="text" id="inp-insta" class="input-sm" placeholder="Instagram URL">
            <div class="section-title">ğŸ¨ ã‚¢ãƒ—ãƒªè¨­å®š</div>
            <div style="display:flex; gap:10px;">
                <button class="btn-primary" id="set-light" style="flex:1; background:#eee; color:#333;">â˜€ï¸ ãƒ©ã‚¤ãƒˆ</button>
                <button class="btn-primary" id="set-dark" style="flex:1; background:#333;">ğŸŒ™ ãƒ€ãƒ¼ã‚¯</button>
            </div>
            <div class="section-title">ğŸ› ï¸ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</div>
            <button class="btn-primary" id="load-demo" style="width:100%; background:var(--ui-accent);">ğŸ­ è£½é€ æ¥­ãƒ‡ãƒ¢ãƒ‡ãƒ¼ã‚¿ã‚’åæ˜ </button>
            <button class="btn-primary" id="clear-all" style="width:100%; background:var(--ui-danger); margin-top:10px;">ğŸ—‘ï¸ ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢</button>
        </div>
        <div style="padding:15px; text-align:right;"><button class="btn-primary" id="close-modal-btn">OK</button></div>
    </div>
</div>

<div class="toast" id="toast"></div>
<input type="file" id="file-input" accept="image/*" style="display:none">

<script>
document.addEventListener('DOMContentLoaded', () => {
    const getEl = (id) => document.getElementById(id);

    // --- Data Templates ---
    const industryData = {
        manufacturing: { catch: "æ—¥æœ¬ã®ã‚‚ã®ã¥ãã‚Šã‚’ã€\nä¸–ç•Œã¸å±Šã‘ã‚‹æŠ€è¡“åŠ›ã€‚", points: ["ç²¾å¯†åŠ å·¥æŠ€è¡“", "çŸ­ç´æœŸå¯¾å¿œ", "è©¦ä½œã‹ã‚‰é‡ç”£ã¾ã§"] },
        wholesale: { catch: "ç‰©æµã®æœ€é©åŒ–ã§ã€\nãƒ“ã‚¸ãƒã‚¹ã‚’åŠ é€Ÿã•ã›ã‚‹ã€‚", points: ["åœ§å€’çš„ãªåœ¨åº«åŠ›", "å³æ—¥é…é€ä½“åˆ¶", "å°ãƒ­ãƒƒãƒˆå¯¾å¿œ"] },
        insurance: { catch: "æœªæ¥ã®å®‰å¿ƒã‚’ã€\nã‚ãªãŸã¨ä¸€ç·’ã«è¨­è¨ˆã—ã¾ã™ã€‚", points: ["ã‚ªãƒ¼ãƒ€ãƒ¼ãƒ¡ã‚¤ãƒ‰ææ¡ˆ", "è¿…é€Ÿãªçµ¦ä»˜ã‚µãƒãƒ¼ãƒˆ", "ä¸‡å…¨ã®ç›¸è«‡ä½“åˆ¶"] },
        renovation: { catch: "ç†æƒ³ã®ä½ã¾ã„ã‚’ã€\nç¢ºã‹ãªæŠ€è¡“ã§å½¢ã«ã—ã¾ã™ã€‚", points: ["å®Œå…¨è‡ªç¤¾æ–½å·¥", "åœ°åŸŸå¯†ç€ã‚µãƒãƒ¼ãƒˆ", "ãƒ—ãƒ­ã®ææ¡ˆåŠ›"] }
    };

    const state = {
        view: 'editor',
        theme: 'light',
        accent: '#020562',
        industry: 'manufacturing',
        company: 'ï¼ˆä¼šç¤¾åã‚’å…¥åŠ›ï¼‰',
        address: '', mapUrl: '', email: '', lineUrl: '', instaUrl: '',
        images: { hero: null, p1: null, p2: null, p3: null }
    };

    // --- Render Website HTML ---
    function buildHTML() {
        const c = state.accent;
        const catchphrase = (industryData[state.industry]?.catch || "Welcome").replace(/\n/g, '<br>');
        const heroBg = state.images.hero ? `background-image:url(${state.images.hero});` : `background:linear-gradient(135deg, ${c}, #0f172a);`;

        const cards = [1,2,3].map(i => {
            const img = state.images[`p${i}`];
            const title = industryData[state.industry]?.points[i-1] || `ç‰¹å¾´ ${i}`;
            const imgDiv = img ? `<div style="height:200px; background:url(${img}) center/cover;"></div>` : `<div style="height:200px; background:#f1f5f9; display:flex; align-items:center; justify-content:center; color:#94a3b8;">NO IMAGE</div>`;
            return `<div style="background:#fff; border-radius:16px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.05);">${imgDiv}<div style="padding:20px;"><h3 style="color:${c}; margin:0 0 10px 0;">${title}</h3><p style="font-size:0.9rem; opacity:0.8; margin:0;">æœ€é«˜å“è³ªã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ãŠå±Šã‘ã—ã¾ã™ã€‚</p></div></div>`;
        }).join('');

        return `<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>${state.company}</title><style>
            body{margin:0; font-family:sans-serif; background:#f8fafc; color:#333; line-height:1.6;}
            header{background:#fff; padding:15px 5%; display:flex; justify-content:space-between; align-items:center; box-shadow:0 1px 5px rgba(0,0,0,0.1); position:sticky; top:0; z-index:100;}
            .hero{height:60vh; min-height:400px; display:flex; align-items:center; justify-content:center; text-align:center; color:#fff; background-size:cover; background-position:center; ${heroBg}}
            .hero h1{font-size:2.4rem; text-shadow:0 4px 20px rgba(0,0,0,0.5); padding:20px; margin:0;}
            section{padding:60px 5%; max-width:1200px; margin:0 auto;}
            .grid{display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:30px;}
            footer{background:#0f172a; color:#fff; text-align:center; padding:50px 20px; font-size:0.8rem;}
        </style></head><body>
            <header><div style="font-weight:bold; color:${c};">${state.company}</div></header>
            <div class="hero"><h1>${catchphrase}</h1></div>
            <section><div class="grid">${cards}</div></section>
            <footer><div>${state.company}</div><div>${state.address}</div></footer>
        </body></html>`;
    }

    function syncUI() {
        document.body.setAttribute('data-theme', state.theme);
        getEl('main-container').className = `app-main view-${state.view}`;
        getEl('mode-editor').classList.toggle('active', state.view === 'editor');
        getEl('mode-preview').classList.toggle('active', state.view === 'preview');
        
        getEl('inp-company').value = state.company;
        getEl('inp-address').value = state.address;
        getEl('industry-select').value = state.industry;

        ['hero', 'p1', 'p2', 'p3'].forEach(k => {
            const img = getEl(`prev-${k}`);
            const ph = getEl(`ph-${k}`);
            if(state.images[k]) {
                img.src = state.images[k]; img.style.display = 'block'; ph.style.display = 'none';
                img.parentElement.classList.add('has-image');
            } else {
                img.style.display = 'none'; ph.style.display = 'flex';
                img.parentElement.classList.remove('has-image');
            }
        });
        getEl('preview-iframe').srcdoc = buildHTML();
    }

    // --- Actions ---
    const showToast = (m) => { const t = getEl('toast'); t.innerText = m; t.classList.add('active'); setTimeout(()=>t.classList.remove('active'),3000); };
    const download = () => {
        const a = document.createElement('a');
        a.href = URL.createObjectURL(new Blob([buildHTML()], {type:'text/html'}));
        a.download = `${state.company}.html`; a.click(); showToast('ä¿å­˜ã—ã¾ã—ãŸï¼');
    };

    // --- Events ---
    getEl('mode-editor').onclick = () => { state.view = 'editor'; syncUI(); };
    getEl('mode-preview').onclick = () => { state.view = 'preview'; syncUI(); };
    getEl('btn-finish-jump').onclick = () => { state.view = 'preview'; syncUI(); };
    getEl('save-top').onclick = download;
    getEl('save-presentation').onclick = download;

    getEl('open-settings').onclick = () => getEl('modal-settings').classList.add('active');
    getEl('close-modal').onclick = () => getEl('modal-settings').classList.remove('active');
    getEl('close-modal-btn').onclick = () => getEl('modal-settings').classList.remove('active');

    getEl('industry-select').onchange = (e) => { state.industry = e.target.value; syncUI(); };
    getEl('inp-company').oninput = (e) => { state.company = e.target.value; syncUI(); };
    getEl('inp-address').oninput = (e) => { state.address = e.target.value; syncUI(); };
    getEl('inp-map').oninput = (e) => { state.mapUrl = e.target.value; syncUI(); };
    getEl('inp-email').oninput = (e) => { state.email = e.target.value; syncUI(); };
    getEl('inp-line').oninput = (e) => { state.lineUrl = e.target.value; syncUI(); };
    getEl('inp-insta').oninput = (e) => { state.instaUrl = e.target.value; syncUI(); };

    getEl('set-light').onclick = () => { state.theme = 'light'; syncUI(); };
    getEl('set-dark').onclick = () => { state.theme = 'dark'; syncUI(); };

    getEl('load-demo').onclick = () => {
        state.company = "å‰ç”°ç²¾å·¥æ ªå¼ä¼šç¤¾"; state.address = "å¤§é˜ªåºœæ±å¤§é˜ªå¸‚"; state.industry = "manufacturing";
        syncUI(); getEl('modal-settings').classList.remove('active'); showToast('ãƒ‡ãƒ¢ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
    };
    getEl('clear-all').onclick = () => { if(confirm('æ¶ˆå»ã—ã¾ã™ã‹ï¼Ÿ')){ localStorage.clear(); location.reload(); } };

    const colors = ['#020562', '#22AEC9', '#10B981', '#F59E0B', '#EC4899'];
    colors.forEach(c => {
        const p = document.createElement('div'); p.className = 'color-pill'; p.style.setProperty('--bg', c);
        p.onclick = () => { state.accent = c; syncUI(); }; getEl('color-pills').appendChild(p);
    });

    let target = null;
    document.querySelectorAll('.photo-card').forEach(c => {
        c.onclick = (e) => { if(e.target.className === 'btn-photo-clear') return; target = c.dataset.target; getEl('file-input').click(); };
    });
    getEl('file-input').onchange = (e) => {
        const f = e.target.files[0]; if(!f) return;
        const r = new FileReader(); r.onload = (ev) => { state.images[target] = ev.target.result; syncUI(); showToast('åæ˜ ã—ã¾ã—ãŸ'); }; r.readAsDataURL(f);
    };
    document.querySelectorAll('.btn-photo-clear').forEach(b => {
        b.onclick = (e) => { e.stopPropagation(); state.images[b.dataset.target] = null; syncUI(); };
    });

    syncUI();
});
</script>
</body>
</html>